# 更新日志

记录霓虹战机项目的版本变更和重要更新。

---

## [v0.6.2] - 2025-11-14

### ✨ 新增

- **looping_curve 自动切线生成**
  - `LoopingCurveBehavior` 支持 `aiParams.auto`，仅需提供入场锚点、圆心与离场坐标即可自动求解正切点，至少绕行半圈并保持速度连续
  - 自动推算出的 `entry / arc / exit` 可被同名字段按需覆盖，用于局部微调切线角度或离场距离
  - 为未来新敌人降低配置难度，编队中的每一架飞机都会共享同一条自动生成的曲线
  - `triangle_loop` / `triangle_loop_shooter` 现作为唯一的环形敌人类型，真实关卡与弧线测试默认应用自动切线方案
  - wave_script 波次可直接覆写 `enemies[]` 中的 `aiParams` / `overrides`，无需再为不同轨迹复制额外敌人 ID（敌人测试关卡第二、三波即为示例）

- **环形尖兵曲线调参能力**
  - `EnemyConfig` 支持可选 `aiParams` 字段，通过 `entry / arc / exit` 三段参数控制入场高度、圆弧半径/角度与离场方向
  - `LoopingCurveBehavior` 根据参数自动重建 Hermite + 圆弧路径，保证过渡连续且保持机头朝向
  - `AISystem` / `AI` 组件新增行为参数透传机制，后续其他行为亦可复用

### 📚 文档

- `README`、`ARCHITECTURE`、`DATA_CONFIG`、`CONFIG_EXAMPLES` 同步说明 `aiParams.auto` 与手动覆盖策略，补充自动切线示例配置
- `enemies.json` 默认为 `triangle_loop` 提供示例配置，便于在不写代码的情况下快速调整弧线形态

### 🔧 修复

- **敌人测试关卡只出现 2 架敌人**
  - `CleanupSystem` 为敌人向上预热保留顶部缓冲，并根据场景中最靠上的敌人动态扩展安全距离，避免列队生成时被错误清理
- **纵向队列敌人重叠**
  - `LoopingCurveBehavior` 会根据实际生成高度自动延长入场段，确保整列敌人沿路径保持间距
- **弧线调试视图与关卡配置不同步**
  - `CurveTestScreen` 直接读取 `enemy_test` 关卡的波次与敌人配置，轨迹效果与实际敌人完全一致，调参后可即时对照
- **敌人测试关卡曲线调试**
  - 关卡默认仅保留基础波次，使用对象覆写 `aiParams` 的示例可按需启用，用于测试镜像、底部离场等不同轨迹组合

---

## [v0.6.1] - 2025-11-11

### 🔧 修复

- **性能系统渲染残留**
  - `PerformanceSystem` 在强制销毁敌人或子弹前同步移除 `Render` 精灵
  - 修复敌人飞出屏幕后静止悬停、无法被击中或碰撞的问题（实体已销毁但精灵残留）
  - 清理 `ENEMY_COLORS` 缓存，避免重复使用同一 ID 时颜色错乱
- **关卡重启速度异常**
  - 修复通关返回主菜单后再次进入关卡时系统重复注册导致的“越玩越快”问题
  - 重置世界系统、事件监听与升级面板，确保每次开局都从干净状态启动

### ✨ 新增

- **环形尖兵编队**
  - 新增 `looping_curve` AI 行为，纵向列队入场 → 屏中画弧 → 由侧翼离场，并保持朝向移动方向
  - 调整运动轨迹为统一圆弧路径，后续敌舰严格沿前机轨迹跟随，形成经典 STG "一串"效果
  - 采用单一参数化路径并结合弧长采样，入场 / 绕圈 / 离场无缝衔接，速度自然过渡
  - 垂直入场后绕向远侧，再沿出生侧水平切线离场，不再出现多余折线
  - 新敌人 `triangle_loop` 使用该行为，默认在 `enemy_test` 关卡中生成 8 敌人一组
  - 主菜单新增 `弧线测试` 调试入口（CurveTestScreen），可视化左右两侧曲线并标记实际生成点
  - 关卡编队新增 `column` 类型（纵向单列），可配置 `x/y/spacing` 参数

### ⚙️ 调整

- **实体数量上限**
  - 将 `RENDER_CONFIG.MAX_ENEMIES` 从 30 提升至 200，满足密集波次下的测试需求
  - 文档同步更新（README、ARCHITECTURE、QUICKSTART）
- **弹幕控制**
  - `PerformanceSystem` 的子弹上限现覆盖玩家、敌人、僚机三类子弹

### ✨ 改进

- **经验掉落一致性**
  - `DeathSystem` 直接使用敌人配置中的 `xpDrop` 生成经验碎片
  - 敌人销毁后清理 `ENEMY_COLORS` 缓存，彻底杜绝颜色残留

### ♻️ 维护

- 移除 `MovementSystem`、`CollisionSystem` 调试日志，恢复正常输出

---

## [v0.6.0] - 2025-11-10

### 🎉 重大更新：敌人武器系统

### ✨ 新增

- **爆发射击系统（Burst Fire）**
  - 敌人武器支持爆发射击模式，创造有节奏的弹幕
  - 可配置每次爆发的子弹数（shotsPerBurst）
  - 可配置爆发内的射击间隔（burstInterval）
  - 可配置爆发后的冷却时间（burstCooldown）
  - 示例：3发爆发，间隔1秒，冷却3秒 → ●-●-●-----●-●-●-----
  - 新增 enemy_burst_shot 武器配置作为示例
  - enemy_aimed_shot（三角狙击手）已应用爆发模式

- **通关系统（VictorySystem）**
  - wave_script 模式支持通关检测（所有波次完成且无敌人）
  - 通关后进入 10 秒收尾阶段，玩家可继续操控飞机捡经验
  - 收尾阶段升级不再暂停游戏，不显示升级面板
  - 倒计时结束或经验豆全部收集后，玩家飞机向上飞离屏幕
  - 飞离完成后自动返回主菜单
  
- **关卡状态管理**
  - LevelState 枚举：PLAYING、VICTORY_CLEANUP、VICTORY_EXIT、FAILED、COMPLETE
  - LevelManager 支持多阶段状态切换
  - 收尾阶段倒计时显示（10→0 秒）

- **关卡记忆功能**
  - 使用 localStorage 保存玩家上次选择的关卡
  - 游戏启动时自动选中上次的关卡
  - 默认选择线性关卡1（首次启动）
  - 提升用户体验，无需重复选择

- **敌人测试关卡**
  - 新增 enemy_test 关卡，专门用于快速测试敌人
  - 1波配置，60秒时长，可灵活调整
  - 方便测试新敌人的行为、移动和攻击方式

### 🎨 UI/美术

- **经验豆形状优化**
  - 经验碎片从圆形改为五角星 ★
  - 更符合游戏主题（小行星 Aster = 星）
  - 视觉辨识度更高，与其他圆形实体区分
  - 霓虹金色五角星，更有收集欲望

- **敌人子弹颜色规范化**
  - 所有敌人子弹颜色调整为符合游戏霓虹风格
  - 普通子弹（直射、瞄准、散射）：霓虹橙 `0xFF8844` (16746564)
  - 特殊子弹（追踪导弹）：霓虹粉 `0xFF0088` (16711816)
  - 统一视觉语言，通过颜色区分子弹类型，提升识别度

- **通关 UI**
  - 显示"游戏通关"文字（霓虹金色）
  - 显示"收集剩余经验"提示
  - 倒计时数字显示（霓虹蓝色）
  - 半透明黑色背景，不遮挡游戏画面

### 🔧 修复

- **敌人子弹生命周期调整**
  - 修复直射弹在屏幕中部消失的问题（3.0s → 5.0s）
  - 修复追踪导弹生命周期过短（5.0s → 6.0s）
  - 修复散射弹生命周期过短（3.5s → 5.0s）
  - 确保所有敌人子弹都能飞到屏幕底部（最大飞行距离 ≥ 1280 像素）

- **通关飞离动画问题**
  - 修复 MovementSystem 边界限制导致飞机无法飞出屏幕顶部
  - 飞离阶段 (VICTORY_EXIT) 禁用 y 轴边界限制，允许向上飞离
  - InputSystem 在飞离阶段禁用玩家输入
  - 经验豆收集完后立即触发飞离（不必等 10 秒）

- **敌人自爆问题（关键Bug修复）**
  - 修复 WeaponSystem 处理所有 Weapon 组件导致敌人自爆
  - 原因：WeaponSystem 没有过滤玩家，导致敌人也发射 Events.SHOOT
  - 结果：玩家子弹在敌人位置生成，立即击中敌人
  - 修复：WeaponSystem 添加 Tag 过滤，只处理玩家（tag === PLAYER）
  - 敌人子弹生成位置优化（沿发射方向偏移 25 像素）
  
- **玩家死亡后崩溃**
  - 修复 CollisionSystem 在玩家死亡后访问 undefined 组件
  - 添加安全检查：playerTransform 和 playerCollider 存在性验证
  - 避免玩家死亡后继续碰撞检测导致的错误

- **代码优化**
  - 清理所有调试日志（CollisionSystem、WeaponSystem、VictorySystem）
  - 保留关键系统日志（关卡加载、错误警告）
  - 移除未使用的导入（Health、LevelConfig）
  
- **CollisionSystem 变量重复赋值**
- **TypeScript 类型错误修复**（EnemyWeaponSystem、HomingSystem）

#### 核心功能
- **敌人武器配置系统**
  - 敌人可装备武器，向玩家发射子弹
  - 武器配置完全复用 weapons.json，通过 category 字段区分玩家/敌人武器
  - 支持 4 种敌人武器预设：直射弹、瞄准弹、追踪导弹、散射弹
  - 发射方向可配置：向下、瞄准玩家、沿敌人朝向、随机方向
  - 支持散射弹幕（spreadCount、spreadAngle）
  
- **追踪导弹系统**
  - 新增 HomingSystem，独立处理子弹追踪逻辑
  - 支持玩家和敌人的追踪导弹
  - 可配置转向速率和追踪范围
  - 平滑转向算法，避免瞬间转向
  
- **射击条件系统**
  - 3 种射击条件：屏幕内（默认）、距离触发、总是射击
  - 首次射击延迟（initialFireDelay）可按敌人类型和波次配置
  - 自动管理敌人射击状态和冷却时间
  
- **关卡倍数系统**
  - 支持波次级武器倍数：damage、fireRate、bulletSpeed、bulletLifetime
  - 支持关卡级全局倍数：enemy（hp、speed）、weapon（所有参数）
  - 配置优先级：波次倍数 > 关卡全局倍数 > 敌人配置 > 武器配置
  - 灵活调整关卡难度曲线

#### 新增敌人
- **六边射手**（hex_shooter）- 向下直射
- **三角狙击手**（triangle_sniper）- 瞄准玩家
- **菱形追踪者**（diamond_tracker）- 发射追踪导弹，距离触发

#### 关卡配置
- **精简关卡列表**：保留 2 个核心关卡
  - **线性关卡1**（linear_01）- wave_script 模式
    - 29 个波次，密集节奏（0-30s 每 2 秒，30-50s 每 2 秒，50-55s 每 1.5 秒）
    - 难度递增，武器倍数从 ×1.2 递增到 ×2.5
    - 展示武器倍数系统、首次射击延迟、5 种编队
    - **支持通关流程**：最后一波敌人消失后进入收尾阶段
  - **测试关卡**（test_level）- algorithm 模式
    - 4 种敌人权重随机
    - 包含射击敌人，难度递增 ×1.03/秒
    - 10 分钟固定时长

#### 系统架构
- **新增系统**：
  - `EnemyWeaponSystem` - 处理敌人武器射击，管理射击条件和延迟
  - `HomingSystem` - 处理追踪导弹的转向逻辑
  - `VictorySystem` - 处理通关流程、收尾阶段、玩家飞离、返回菜单
  
- **新增组件**：
  - `Projectile.owner` - 标识子弹所有者（player/enemy）
  
- **新增实体**：
  - `EnemyBullet` - 敌人子弹实体工厂
  
- **扩展类型**：
  - `WeaponConfig` - 添加 category、fireDirection
  - `EnemyConfig` - 添加 weaponId、initialFireDelay、shootingCondition
  - `LevelConfig` - 添加 globalMultipliers、globalInitialFireDelay
  - `WaveConfig` - 添加 weaponMultipliers、enemyMultipliers、initialFireDelay

#### 碰撞系统更新
- 敌人子弹只能击中玩家
- 玩家子弹只能击中敌人和 Boss
- 子弹 owner 字段自动区分碰撞逻辑

#### 配置文件更新
- `weapons.json` - 添加 4 种敌人武器配置
- `enemies.json` - 添加 3 个带武器的新敌人
- `levels.json` - 添加射击者考验关卡，展示倍数系统

### 📖 文档
- `DATA_CONFIG.md` - 完善武器和敌人配置说明，添加敌人武器字段
- `LEVEL_CONFIG.md` - 新增武器倍数系统、首次射击延迟、全局倍数配置说明
- `ARCHITECTURE.md` - 更新系统列表，添加 EnemyWeaponSystem 和 HomingSystem
- `CHANGELOG.md` - 记录本次重大更新

### 🔧 技术细节
- 敌人创建时自动添加 Weapon 组件（如果配置了 weaponId）
- EnemyWeaponSystem 从 EnemyData 读取射击配置
- 配置合并逻辑支持多层覆盖（波次 > 关卡 > 敌人 > 武器）
- 所有玩家子弹标记 owner='player'，所有敌人子弹标记 owner='enemy'

---

## [v0.5.0] - 2025-11-09

### 🎉 重大更新：颜色设计规范体系

### 🔧 修复

- **UI重叠问题**
  - 修复通关后重新进入游戏时HUD元素重叠的问题
  - 返回主菜单时清理所有游戏UI容器（除了菜单界面）
  - 确保每次进入游戏都使用干净的UI状态

### 🎨 视觉优化

- **经验碎片形状调整**
  - 五角星内半径比例从0.4增加到0.6
  - 形状更圆润、更胖，不再尖锐
  - 保持相同的外围尺寸

### ✨ 新增

- **通关结算界面**（GameResultScreen）
  - 关卡完成时显示统计数据
  - 显示击败敌人数、获得经验、生存时间
  - 霓虹风格统计面板（450x280）
  - 双层霓虹边框（青蓝+粉红）
  - 返回主菜单按钮
  - 游戏统计追踪系统（实时记录击败敌人数和获得经验）
  - 延迟1秒显示（让玩家飞离屏幕）

- **通关飞离动画优化**
  - 玩家飞离速度提升至800（原来的2倍）
  - 飞离时禁用玩家和僚机的所有射击
  - **通关瞬间清除所有敌人和敌人子弹**
  - 画面干净利落，通关瞬间更有冲击力

### 🎨 UI/美术

- **主菜单关卡卡片设计**
  - 移除"选择关卡"按钮，改为显示关卡卡片预览
  - 卡片显示当前选中关卡的完整信息（400x180）
  - 包含关卡名称、类型标签、时长、难度、描述
  - 边框颜色根据关卡类型动态变化（限时=青、无尽=紫、Boss=粉、生存=金）
  - 卡片支持悬停效果（缩放1.03倍，发光增强）
  - 点击卡片打开关卡选择界面
  - **动态更新**：选择新关卡后，卡片自动刷新显示新关卡信息
  - 菜单布局优化：关卡卡片在中部，按钮在下部

### 🔧 修复

- **受击颜色恢复问题**
  - 修复玩家受击后颜色恢复为旧绿色的问题（HealthSystem.ts + DeathSystem.ts）
  - 修复敌人受击后形状错误的问题（粉色三角变六边形）
  - HealthSystem现在从配置读取形状，而非通过颜色推断
  - 确保所有实体受击后正确恢复为新颜色规范

- **默认颜色参数修复**
  - 修复NeonRenderer中敌人创建方法的默认颜色（ENEMY_BASIC → ENEMY_HEXAGON/TRIANGLE）
  - 修复UpgradeSystem中僚机默认颜色（0xffd44d → COLORS.COMPANION）
  - 修复UISystem中Game Over文字颜色（ENEMY_BOSS → DAMAGE_TEXT）
  - 更新所有过时的注释（玩家"绿色"→"霓虹蓝"等）

- **文档描述更新**
  - 更新所有文档中"绿色箭头飞船"→"霓虹蓝箭头飞船"
  - 更新"金色僚机"→"霓虹青僚机"
  - 更新"白色子弹"→"浅蓝子弹"
  - 更新DATA_CONFIG.md中的颜色参考表
  - 清理所有过时的颜色描述

### 🎉 重大更新：颜色设计规范体系

#### 颜色规范文档
- **新建文档**：`docs/COLOR_DESIGN.md`
  - 完整的霓虹赛博朋克颜色体系
  - 7种核心色调定义（霓虹蓝/粉/紫/橙/金/绿/青）
  - 实体颜色分配规则（玩家/敌人/Boss/拾取物）
  - UI颜色使用规范
  - 特效颜色标准
  - 颜色组合建议与禁止事项
  - 代码实现参考与色值转换表

#### 颜色系统重构
- **玩家系统**：
  - 玩家飞机：绿色 → 霓虹蓝（0x00b8ff）
  - 玩家子弹：白色 → 浅蓝（0x88ddff）
  - 僚机：新增霓虹青（0x00ddff）
  - 僚机子弹：新增淡青（0x66ccff）

- **敌人系统**（按形状分类）：
  - 六边形：霓虹蓝（0x00b8ff）
  - 三角形/箭头：霓虹粉（0xff0088）
  - 方形/菱形：霓虹紫（0xaa44ff）
  - 圆形：霓虹青（0x00ddff）

- **Boss系统**：
  - Boss主体：红色 → 霓虹粉（0xff0088）
  - Boss发光：新增霓虹紫（0xaa44ff）叠加
  - Boss子弹：新增粉紫混合（0xff44aa）

- **拾取物**：
  - 经验碎片：保持霓虹金（0xffdd44）
  - 治疗包：保持霓虹绿（0x00ff88）
  - 特殊道具：新增霓虹紫（0xaa44ff）

- **UI系统**：
  - 主UI：青色 → 霓虹蓝（0x00b8ff）
  - 进度条：绿色 → 霓虹蓝（0x00b8ff）
  - 警告：保持霓虹橙（0xff8844）
  - 伤害数字：红色 → 霓虹粉（0xff0088）
  - 治疗数字：保持霓虹绿（0x00ff88）

#### 配置文件更新
- `src/config/constants.ts` - 完全重构COLORS对象，新增所有颜色常量
- `public/data/players/players.json` - 玩家颜色更新为霓虹蓝（47359）
- `public/data/enemies/enemies.json` - 敌人颜色按形状更新
- `public/data/bosses/bosses.json` - Boss颜色更新为霓虹粉（16711816）

#### UI组件更新
- `src/ui/UpgradePanel.ts` - 升级卡稀有度颜色使用新规范
- `src/ui/LevelSelectScreen.ts` - 关卡类型颜色使用新规范
- `src/ui/TalentScreen.ts` - 天赋界面使用霓虹蓝
- `src/systems/UISystem.ts` - 血量显示、经验条使用新颜色

### 📖 文档

- `docs/COLOR_DESIGN.md` - 新增完整颜色设计规范文档
- `README.md` - 新增"颜色设计规范"章节（第4章），调整后续章节编号
- `README.md` - 相关文档列表新增颜色规范链接

---

## [v0.4.1] - 2025-11-09

### 🎨 UI/美术

- **主菜单界面重构**
  - 使用霓虹风格标题图片替代文本标题
  - 标题图片添加呼吸脉冲动画（±3% 缩放）
  - 标题Logo大幅放大（最大宽度 98%，最大高度 585px，是原设计的近3倍）
  - Logo位置 Y=340，整体界面下移，视觉更震撼
  - 加载失败时自动降级为文本标题
  - 图片资源路径：`/public/images/title.png`

### ♻️ 优化

- **菜单布局优化**
  - Logo上方留白适中，整体界面下移优化平衡感
  - 按钮位置在中部偏下（Y=720），与大Logo配合更协调
  - 按钮间距增加至 100px，呼吸感更强
  - 移除底部操作提示文字，界面更简洁
  - 菜单元素整体布局更加协调大气
- **菜单按钮视觉升级**
  - 按钮尺寸大幅增加（373x80，增大约33%）
  - 字体大小增大（普通按钮 21px，主按钮 24px）
  - 圆角增大至 16 像素，更加圆润
  - "进入游戏"按钮作为主按钮高亮显示
  - **霓虹渐变配色**（与Logo风格统一）：
    - 双层边框：偏蓝青色（0x00b8ff）+ 粉红色（0xff0088）
    - 双层发光：偏蓝青色和粉红色叠加，营造霓虹效果
    - 主按钮文字使用偏蓝青色到粉红的水平渐变
    - 文字添加偏蓝青色阴影增强霓虹感
    - 颜色调整为更偏蓝，更接近Logo中的蓝色
  - 悬停时边框和发光同步增强
  - 背景透明度优化（深色半透明）

### 📖 文档

- `README.md` - 更新"3.1 启动与主菜单"章节，详细说明新的菜单设计
- `/public/images/README.md` - 新增资源说明文档

---

## [v0.3.5] - 2025-11-08

### ✨ 新增

- **天赋解锁机制重构**
  - 核心回路初始未激活，消耗 1 星级点数后激活
  - 激活后周围 5 个节点显示真实图标与名称，可点击查看 Tips
  - 问号节点（前置未激活）不可点击、无 Tips、仅作预览
  - 每次激活节点后，下游问号节点逐步扩散，形成层次解锁

### ♻️ 优化

- **UI 模块化**
  - 新增 `src/ui/talent/TalentTooltip.ts` 封装提示卡逻辑
  - 提示卡自动定位，支持屏幕边界约束与上/下翻转
  - 提示卡字体放大 50%，内容自动换行与动态高度
  - 移除状态文字展示，简化信息层级
- **日志管理**
  - `GameEngine` 新增调试开关，生产环境静默日志输出

### 📖 文档

- `DATA_CONFIG.md` 新增天赋配置字段说明与示例
- `ARCHITECTURE.md` 补充主菜单/天赋流程与暂停机制
- `README.md` 更新天赋解锁与扩散逻辑说明

---

## [v0.4.0] - 2025-11-08

### 🎉 重大更新：关卡系统

#### 核心功能
- **关卡配置系统**
  - 支持 3 种关卡类型：固定时长/无尽模式/Boss战
  - 配置文件：`levels.json`（3个初始关卡）
  - 完整类型定义（LevelConfig/WaveConfig/BossConfig）
  
- **WaveSystem**（波次管理）
  - 脚本化波次：精确时间轴控制敌人生成
  - 算法生成：按权重随机，难度递增
  - 支持混合模式
  
- **编队系统**
  - 5种编队：随机/直线/V字/圆形/波浪
  - FormationFactory 工厂模式
  - 可自定义参数（间距/半径/角度）
  
- **Boss 系统**
  - 多阶段配置（HP阈值触发）
  - BossSystem 自动切换阶段
  - AI模式/移速/技能可配置
  - Boss 配置文件：`bosses.json`
  
- **关卡选择UI**
  - LevelSelectScreen：显示所有可选关卡
  - 关卡卡片（名称/类型/时长/难度/描述）
  - 根据类型的彩色边框

#### 替换与优化
- WaveSystem 替代旧的 EnemySpawnSystem
- BossSystem 新增
- LevelManager 单例管理关卡状态

### ✨ 新增（其他）

- **DPS与经验收益显示**
  - 右上角实时显示 DPS（最近1秒）
  - 显示 XP/10s（最近10秒经验收益）
  - 用于评估火力与效率

- **测试升级优化**
  - 点击测试升级按钮时玩家等级+1
  - 显示Lv实时更新

### 🔧 修复
- 修复编译错误（BossPhase重复/未使用导入）
- 优化高频日志（移除战斗日志，提升性能）

---

## [v0.3.4] - 2025-11-08

### ✨ 新增（升级与僚机）

- **分级升级系统**
  - 每个升级支持多级（通常 3-4 级），每级效果可独立配置
  - 显示规则：首级 "名称 New"，中间 "名称 Lv.N"，满级 "名称 Max"
  - 满级升级自动从卡池移除
  - 配置文件升级至 v1.1.0（`upgrades.json` 使用 `levels` 结构）
  - 新增 `UpgradeProgress` 组件记录玩家各升级等级

- **弹射子弹**（原弹跳子弹重构）
  - 子弹命中敌人后自动寻找最近的另一敌人并改变弹道
  - 与穿透共存时随机选择弹射或穿透（弹射无目标时回退穿透）
  - 升级配置改为 `chain` 属性

- **僚机支援**（史诗升级）
  - 霓虹青小箭头僚机，最多 4 架，160° 扇形对称分布
  - 固定槽位，按 [左内, 右内, 左外, 右外] 对称补齐
  - 僚机垂直向上射击，伤害为主武器 50%，射速与主武器一致
  - 所有僚机共享冷却，同步齐射
  - 僚机参数可通过 `extra` 配置（fireRate/damageRatio/bulletSpeed/bulletSize）

- **调试升级面板**
  - 点击"测试升级"按钮显示所有未满级升级及其真实概率
  - 支持取消按钮（调试模式专属）

- **moveSpeed/magnetRange/xpGain 接线生效**
  - 新增 `PlayerStats` 组件汇总最终属性
  - `InputSystem`、`PickupSystem` 读取并应用这些倍率

### 🔧 修复

- 修复穿透子弹逻辑（`hitSet` 防止重复命中同一敌人）
- 修复僚机跟随与射击依赖问题
- 清理未使用的导入与变量

### 📖 文档

- `UPGRADE_SYSTEM.md`：新增分级配置示例、满级过滤、弹射/穿透协同、僚机说明
- `DATA_CONFIG.md`：新增 `upgrades.json` 分级结构与兼容说明
- `ARCHITECTURE.md`：补充 `