# å‡çº§ç³»ç»Ÿæ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ Roguelite å‡çº§ç³»ç»Ÿçš„è®¾è®¡å’Œä½¿ç”¨ã€‚

---

## ğŸ“– ç³»ç»Ÿæ¦‚è¿°

### æ ¸å¿ƒæœºåˆ¶

ç©å®¶é€šè¿‡å‡»æ€æ•Œäººè·å¾—ç»éªŒï¼Œå‡çº§æ—¶å¯ä»¥ä» 3 å¼ éšæœºå‡çº§å¡ä¸­é€‰æ‹© 1 å¼ ï¼Œæ°¸ä¹…å¼ºåŒ–è§’è‰²å±æ€§ã€‚

### è®¾è®¡ç›®æ ‡

- ğŸ² **éšæœºæ€§** - æ¯æ¬¡å‡çº§é€‰é¡¹ä¸åŒ
- ğŸ”„ **å¯å åŠ ** - åŒä¸€å‡çº§å¯å¤šæ¬¡é€‰æ‹©
- âš–ï¸ **å¹³è¡¡æ€§** - ç¨€æœ‰åº¦å†³å®šå¼ºåº¦
- ğŸ¨ **è§†è§‰åŒ–** - æ¸…æ™°çš„UIåé¦ˆ

---

## ğŸ® ç©å®¶ä½“éªŒ

### å‡çº§æµç¨‹

```
1. å‡»æ€æ•Œäººè·å¾—ç»éªŒ
   â†“
2. ç»éªŒæ»¡åå‡çº§
   â†“
3. æ¸¸æˆæš‚åœï¼Œæ˜¾ç¤ºå‡çº§é¢æ¿
   â†“
4. æ˜¾ç¤º 3 å¼ éšæœºå‡çº§å¡
   â†“
5. ç©å®¶ç‚¹å‡»é€‰æ‹©1å¼ 
   â†“
6. å±æ€§ç«‹å³ç”Ÿæ•ˆ
   â†“
7. ç»§ç»­æ¸¸æˆ
```

---

## ğŸ“Š å¯å‡çº§å±æ€§åˆ—è¡¨

### æ”»å‡»ç³»ï¼ˆ5ç§ï¼‰

| å‡çº§åç§° | æ•ˆæœ | ç¨€æœ‰åº¦ | è¯´æ˜ |
|---------|------|--------|------|
| ç«åŠ›æå‡ | ä¼¤å®³ +10% | æ™®é€š | æå‡å­å¼¹ä¼¤å®³ |
| ç–¾é€Ÿå°„å‡» | å°„é€Ÿ +15% | æ™®é€š | æå‡å°„å‡»é¢‘ç‡ |
| æé€Ÿå¼¹é“ | å¼¹é€Ÿ +20% | æ™®é€š | å­å¼¹é£å¾—æ›´å¿« |
| ç©¿é€å­å¼¹ | ç©¿é€ +1 | ç¨€æœ‰ | å¯ç©¿é€æ•Œäºº |
| å¼¹è·³å­å¼¹ | å¼¹è·³ +1 | ç¨€æœ‰ | ç¢°å£å¼¹è·³ |

### ç”Ÿå­˜ç³»ï¼ˆ2ç§ï¼‰

| å‡çº§åç§° | æ•ˆæœ | ç¨€æœ‰åº¦ | è¯´æ˜ |
|---------|------|--------|------|
| ç”Ÿå‘½å¼ºåŒ– | æœ€å¤§HP +20 | æ™®é€š | æå‡ç”Ÿå­˜èƒ½åŠ› |
| ç§»é€Ÿæå‡ | é€Ÿåº¦ +10% | æ™®é€š | ç§»åŠ¨æ›´å¿« |

### æ•ˆç‡ç³»ï¼ˆ2ç§ï¼‰

| å‡çº§åç§° | æ•ˆæœ | ç¨€æœ‰åº¦ | è¯´æ˜ |
|---------|------|--------|------|
| ç£åŠ›å¢å¼º | ç£å¸ +30% | æ™®é€š | æ‹¾å–èŒƒå›´æ‰©å¤§ |
| ç»éªŒåŠ æˆ | ç»éªŒ +20% | ç¨€æœ‰ | å‡çº§æ›´å¿« |

### è§†è§‰ç³»ï¼ˆ1ç§ï¼‰

| å‡çº§åç§° | æ•ˆæœ | ç¨€æœ‰åº¦ | è¯´æ˜ |
|---------|------|--------|------|
| å·¨å¤§åŒ– | å­å¼¹å¤§å° +30% | æ™®é€š | å­å¼¹æ›´å¤§ |

---

## âš™ï¸ æŠ€æœ¯å®ç°

### ç»„ä»¶ç³»ç»Ÿ

#### StatModifier ç»„ä»¶
```typescript
interface StatModifier {
  modifiers: {
    stat: string;          // å±æ€§å
    operation: 'add' | 'multiply';  // æ“ä½œç±»å‹
    value: number;         // æ•°å€¼
  }[];
}
```

#### å±æ€§è®¡ç®—å…¬å¼
```typescript
æœ€ç»ˆå€¼ = (åŸºç¡€å€¼ + æ‰€æœ‰åŠ æ³•ä¿®æ”¹å™¨) Ã— æ‰€æœ‰ä¹˜æ³•ä¿®æ”¹å™¨çš„ä¹˜ç§¯
```

### é…ç½®æ ¼å¼

**æ–‡ä»¶**: `public/data/upgrades/upgrades.json`

```json
{
  "id": "damage_boost_1",
  "name": "ç«åŠ›æå‡",
  "description": "ä¼¤å®³ +10%",
  "rarity": "common",
  "effects": [
    {
      "stat": "damage",
      "operation": "multiply",
      "value": 1.1
    }
  ]
}
```

---

## ğŸ¨ UI è®¾è®¡

### å‡çº§é¢æ¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          é€‰æ‹©å‡çº§                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚æ™®é€š â”‚  â”‚ç¨€æœ‰ â”‚  â”‚æ™®é€š â”‚         â”‚
â”‚  â”‚     â”‚  â”‚     â”‚  â”‚     â”‚         â”‚
â”‚  â”‚ç«åŠ› â”‚  â”‚ç©¿é€ â”‚  â”‚ç§»é€Ÿ â”‚         â”‚
â”‚  â”‚æå‡ â”‚  â”‚å­å¼¹ â”‚  â”‚æå‡ â”‚         â”‚
â”‚  â”‚     â”‚  â”‚     â”‚  â”‚     â”‚         â”‚
â”‚  â”‚ä¼¤å®³ â”‚  â”‚ç©¿é€ â”‚  â”‚é€Ÿåº¦ â”‚         â”‚
â”‚  â”‚+10% â”‚  â”‚ +1  â”‚  â”‚+10% â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç¨€æœ‰åº¦é¢œè‰²

| ç¨€æœ‰åº¦ | è¾¹æ¡†é¢œè‰² | æ¦‚ç‡ |
|--------|----------|------|
| æ™®é€š | ç°è‰² `#888888` | 70% |
| ç¨€æœ‰ | ç´«è‰² `#aa44ff` | 25% |
| å²è¯— | é‡‘è‰² `#ffaa00` | 5% |

---

## ğŸ“ å¦‚ä½•æ·»åŠ æ–°å‡çº§å¡

### æ­¥éª¤ 1ï¼šç¼–è¾‘é…ç½®æ–‡ä»¶

**æ–‡ä»¶**: `public/data/upgrades/upgrades.json`

```json
{
  "id": "crit_chance_1",
  "name": "è‡´å‘½ä¸€å‡»",
  "description": "æš´å‡»ç‡ +15%",
  "rarity": "rare",
  "effects": [
    {
      "stat": "critChance",
      "operation": "add",
      "value": 0.15
    }
  ],
  "tags": ["attack", "crit"]
}
```

### æ­¥éª¤ 2ï¼šåˆ·æ–°æ¸¸æˆ

é…ç½®ä¼šè‡ªåŠ¨åŠ è½½ï¼Œæ–°å‡çº§å¡ä¼šå‡ºç°åœ¨éšæœºæ± ä¸­ã€‚

### æ­¥éª¤ 3ï¼šå®ç°å±æ€§æ•ˆæœï¼ˆå¦‚æœæ˜¯æ–°å±æ€§ï¼‰

å¦‚æœæ˜¯å…¨æ–°çš„å±æ€§ï¼ˆå¦‚ critChanceï¼‰ï¼Œéœ€è¦ï¼š
1. åœ¨ `StatModifierSystem` ä¸­æ·»åŠ åº”ç”¨é€»è¾‘
2. åœ¨ç›¸å…³ç³»ç»Ÿä¸­ä½¿ç”¨ä¿®æ”¹åçš„å€¼

---

## ğŸ”„ å±æ€§ä¿®æ”¹å™¨å·¥ä½œåŸç†

### ç¤ºä¾‹ï¼šä¼¤å®³è®¡ç®—

```typescript
// åŸºç¡€ä¼¤å®³
baseDamage = 12

// ç©å®¶é€‰æ‹©äº†ï¼š
// 1. ç«åŠ›æå‡ï¼ˆä¼¤å®³ Ã—1.1ï¼‰
// 2. ç«åŠ›æå‡ï¼ˆä¼¤å®³ Ã—1.1ï¼‰åˆé€‰äº†ä¸€æ¬¡
// 3. ä¼¤å®³ +5ï¼ˆå‡è®¾ï¼‰

// è®¡ç®—è¿‡ç¨‹
addValue = 5
multiplyValue = 1.1 Ã— 1.1 = 1.21

æœ€ç»ˆä¼¤å®³ = (12 + 5) Ã— 1.21 = 20.57
```

### å åŠ è§„åˆ™

- **åŒç±»å‹åŠ æ³•**ï¼šç›´æ¥ç›¸åŠ 
- **åŒç±»å‹ä¹˜æ³•**ï¼šç›¸ä¹˜ï¼ˆ1.1 Ã— 1.1 = 1.21ï¼‰
- **ä¸åŒç±»å‹**ï¼šåˆ†åˆ«è®¡ç®—ååˆå¹¶

---

## ğŸ¯ å¹³è¡¡å»ºè®®

### æ•°å€¼è®¾è®¡åŸåˆ™

1. **æ™®é€šå‡çº§**ï¼š10-15% æå‡
2. **ç¨€æœ‰å‡çº§**ï¼š20-30% æå‡æˆ–ç‰¹æ®Šæ•ˆæœ
3. **å²è¯—å‡çº§**ï¼š50%+ æå‡æˆ–å˜é©æ€§æ•ˆæœ

### å åŠ ä¸Šé™

å»ºè®®è®¾ç½®è½¯ä¸Šé™ï¼Œé¿å…æ•°å€¼çˆ†ç‚¸ï¼š
- åŒä¸€å±æ€§é€‰æ‹© 3-5 æ¬¡åè¾¹é™…æ”¶ç›Šé€’å‡
- æˆ–è€…å‡ºç°æ¬¡æ•°é™åˆ¶ï¼ˆmaxStacksï¼‰

---

## ğŸš€ æ‰©å±•æ–¹å‘

### æœªæ¥å¯æ·»åŠ 

#### å¤æ‚æ•ˆæœ
- **æ¡ä»¶è§¦å‘** - ä½è¡€é‡æ—¶ä¼¤å®³ç¿»å€
- **ç»„åˆæ•ˆæœ** - åŒæ—¶æ‹¥æœ‰Aå’ŒBæ—¶è§¦å‘C
- **å˜é©æ€§å‡çº§** - æ”¹å˜æ¸¸æˆç©æ³•ï¼ˆå¦‚æ¿€å…‰æŸï¼‰

#### å‡çº§è¿›åŒ–
- åŒä¸€å‡çº§é€‰æ‹©3æ¬¡åè¿›åŒ–ä¸ºæ›´å¼ºç‰ˆæœ¬
- ä¾‹å¦‚ï¼šç«åŠ›æå‡ â†’ ç«åŠ›çˆ†å‘ â†’ æ¯ç­ä¹‹åŠ›

#### ç¨€æœ‰åº¦æå‡
- æ·»åŠ ä¼ è¯´çº§ï¼ˆLegendaryï¼‰
- æ·»åŠ ç¥è¯çº§ï¼ˆMythicï¼‰

---

## ğŸ“š é…ç½®å­—æ®µå‚è€ƒ

### UpgradeConfig

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | string | å”¯ä¸€æ ‡è¯†ç¬¦ |
| `name` | string | æ˜¾ç¤ºåç§° |
| `description` | string | æ•ˆæœæè¿° |
| `rarity` | string | ç¨€æœ‰åº¦ï¼šcommon/rare/epic |
| `effects` | StatEffect[] | æ•ˆæœåˆ—è¡¨ |
| `tags` | string[] | æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰ |

### StatEffect

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `stat` | string | å±æ€§å |
| `operation` | string | addï¼ˆåŠ æ³•ï¼‰æˆ– multiplyï¼ˆä¹˜æ³•ï¼‰ |
| `value` | number | æ•°å€¼ |

---

## ğŸ› è°ƒè¯•

### æŸ¥çœ‹ç©å®¶å‡çº§

åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼š
```javascript
// æŸ¥çœ‹ç©å®¶çš„ä¿®æ”¹å™¨
const player = world.entities.find(e => e.getComponent('Tag')?.value === 'player');
const statMod = player.getComponent('StatModifier');
console.log(statMod.modifiers);
```

### å¼ºåˆ¶è§¦å‘å‡çº§

```javascript
world.eventBus.emit('levelup', { level: 2 });
```

---

**ç‰ˆæœ¬**: 1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-11-06

